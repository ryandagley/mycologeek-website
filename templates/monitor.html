<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mycologeek - Artemis Lab Monitor</title>

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/png" href="static/img/favicon.png">

    <!-- Boostrap Core CSS-->
    <link rel="stylesheet" href="static/css/bootstrap.min.css">

    <!-- Main CSS -->
    <link rel="stylesheet" href="static/css/style.css">

    <!-- Animate CSS -->
    <link href="static/css/animate.css" rel="stylesheet">

    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Oxygen:400,300' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css2?family=Life+Savers:wght@400;700&display=swap" rel="stylesheet">

    <!-- Font awesome -->
    <link href="static/font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- ChartJS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <!-- Start wrapper -->
    <div class="wrapper">
        <div class="col-md-12">

            <!-- Navigation -->
            <nav class="navbar navbar-default" role="navigation">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li>
                            <a href="index.html">Home</a>
                         </li>
                            <li class="dropdown">
                              <a href="about.html" class="dropdown-toggle" data-toggle="dropdown">About<b class="caret"></b></a>
                              <ul class="dropdown-menu">
                                  <li>
                                      <a href="about.html">About Mycologeek</a>
                                  </li>
                                  <li>
                                      <a href="about-ryan.html">About Ryan</a>
                                  </li>
                              </ul>
                          </li>
                        <li class="active">
                            <a href="monitor.html">Monitor</a>
                        </li>
                        <li>
                            <a href="gallery.html">Gallery</a>
                        </li>
                        <li>
                            <a href="technical.html">Technical</a>
                        </li>
                        <li>
                            <a href="blog.html">Blog</a>
                        </li>
                    </ul>
                </div>
                <!-- /navbar-collapse -->
            </nav>
            <!-- End nav -->

            <section></section>
                <h2 class="heading-inner">Lab Monitor</h3>    
                    <p>The Lab Monitor is a dashboard that displays data collected from the lab's sensors, 
                        offering insights into environmental conditions and other key metrics. As the lab expands, 
                        more sensors and data streams will be added, making the dashboard a central hub for tracking 
                        and analyzing the lab's ongoing experiments and environment.</p>                
                </div>
            </section>


<!-- Weather Report Section -->
<section>
    <h3 class="heading-inner">Weather Report</h3>
    <div class="weather-container">
        <!-- Weather Report -->
        <div class="weather-card" style="background-image: url('/static/img/{{ background_image }}');">
            <div class="weather-text">
                <h4>Current weather at Artemis Lab in {{ city }}</h4>
                <ul>
                    <li><strong>Today's Weather:</strong> {{ temperature.description }}</li>
                    <li><strong>Temperature:</strong> {{ temperature.temperature }}°F</li>
                    <li><strong>Humidity:</strong> {{ temperature.humidity }}%</li>
                    <li><strong>Today's High/Low: </strong> {{ temperature.temp_max }} °F/ {{ temperature.temp_min }} °F</li>
                </ul>
            </div>
        </div>

        <!-- Weather Chart -->
        <div class="weather-chart">
            <canvas id="weatherChart" width="400" height="300"></canvas>
        </div>
    </div>
</section>

            <!-- Historical Weather Data Section -->
            <section>
                <h3 class="heading-inner">Historical Weather Data</h3>
                <p>Weather for the past 10 days in Tacoma, WA, home of the Mycologeek project.</p>
                <div class="weather-history">
                    <!-- Existing table code for weather history -->
                    {% if historical_weather %}
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>City</th>
                                <th>Temperature (°F)</th>
                                <th>Humidity (%)</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for entry in historical_weather %}
                            <tr>
                                <td>{{ entry.date }}</td>
                                <td>{{ entry.city }}</td>
                                <td>{{ entry.temperature }}</td>
                                <td>{{ entry.humidity }}</td>
                                <td>{{ entry.description }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <p>No historical data available</p>
                    {% endif %}
            
                    
                </div>
            </section>
            



            <section>
                <h3 class="heading-inner">Sensor Data</h3>
                <p>These are the sensors for the Artemis Mushroom Lab!  I build sensors to keep track of the lab environment.  Currently tracking temperature from two sensors!</p>
                <div class="sensor-data">
                    {% if sensor_data %}
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Sensor 0 Temperature (°F)</th>
                                <th>Sensor 1 Temperature (°F)</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for reading in sensor_data %}
                            <tr>
                                <td>{{ reading.timestamp }}</td>
                                <td>{{ reading.sensor_0_temperature_F }}</td>
                                <td>{{ reading.sensor_1_temperature_F }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <p>No sensor data available</p>
                    {% endif %}
                </div>
            </section>
            

            <!-- Footer -->
            <div class="footer col-md-6 col-xs-offset-3">
                <h5>Powered by Caffeine and Terpenes<br />
                    <a href="disclaimer.html">DISCLAIMER</a>
                </h5>
            </div>
            <!-- End footer -->

        </div>
        <!-- End col-md-12 -->

    </div>
    <!-- End wrapper -->

    <!-- Smooth scroll JS -->
    <script src="static/js/smoothscroll.js"></script>

    <!-- Wow JavaScript -->
    <script src="static/js/wow.js"></script>




    <script>
        // Pass data from Flask to JavaScript as JSON
        var dates = {{ dates | tojson }};
        var temperatures = {{ temperatures | tojson }};
        var humidities = {{ humidities | tojson }};
    
        // Reverse the arrays to display oldest to newest
        dates = dates.reverse();
        temperatures = temperatures.reverse();
        humidities = humidities.reverse();
    
        // Pre-format the date strings into "MMM DD" (e.g., "Oct 07")
        dates = dates.map(function(dateString) {
            var parsedDate = new Date(dateString);
            return parsedDate.toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric'
            });
        });
        
        var ctx = document.getElementById('weatherChart').getContext('2d');
    
        var weatherChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: dates, 
                datasets: [{
                    label: 'Temperature (°F)',
                    data: temperatures,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    fill: true,
                    yAxisID: 'y1',
                },
                {
                    label: 'Humidity (%)',
                    data: humidities,
                    borderColor: 'rgba(153, 102, 255, 1)',
                    backgroundColor: 'rgba(153, 102, 255, 0.2)',
                    fill: true,
                    yAxisID: 'y2',
                }]
            },
            options: {
                scales: {
                    x: {
                        ticks: {
                            minRotation: 90,
                            maxRotation: 90,
                            color: '#ffffff'
                        },
                    grid: {
                        color: '#444444'  
                    }
                },
                y1: {
                    type: 'linear',
                    position: 'left',
                    title: {
                        display: true,
                        text: 'Temperature (°F)',
                        color: '#ffffff' 
                    },
                    ticks: {
                        color: '#ffffff'  
                    },
                    grid: {
                        color: '#444444'  
                    }
                },
                y2: {
                    type: 'linear',
                    position: 'right',
                    title: {
                        display: true,
                        text: 'Humidity (%)',
                        color: '#ffffff'  
                    },
                    ticks: {
                        color: '#ffffff' 
                    },
                    grid: {
                        color: '#444444'  
                    }
                }
            },
            plugins: {
                legend: {
                    labels: {
                        color: '#ffffff'  
                    }
                }
            },
            layout: {
                padding: 20  
            }
        },
        plugins: [{
            beforeDraw: function(chart) {
                var ctx = chart.ctx;
                ctx.fillStyle = '#333333';  
                ctx.fillRect(0, 0, chart.width, chart.height);
            }
        }]
    });
</script>
    
    
    
</body>

</html>
